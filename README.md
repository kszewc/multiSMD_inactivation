# multiSMD_inactivation

This is the instruction for the usage of a method presented in the manuscript  
"Evaluating the ligands potency to affect the fast inactivation of voltage-gated sodium channel"  
by Beata Niklas, Milena Jankowska, Katarzyna Walczewska-Szewc, Bruno Lapied and Wieslaw Nowak  

This is the modification of the multiSMD method developed by Katarzyna Walczewska-Szewc, which can be found at: https://github.com/kszewc/multiSMD  

The modified method aims to test the potency of ligands and/or mutations to affect the fast inactivation mechanism of voltage-gated sodium channel.  
  
  
List of files:  
- SMDgen_Nav_inactivation.py -> generates inputs for SMD simulations (multiple directions) of MFM/IFM binding to its pocket  
- SMDgen_Nav_recovery.py -> generates inputs for SMD simulations (multiple directions) of MFM/IFM unbinding  
- analyze_singlerep_alldirs.py -> extract information from trajectories and log files, generates a plot -> single trajectories in multiple directions  
- analyze_nreps_onedir.py -> extract information from trajectories and log files, generates a plot -> multiple trajectories in chosen directory (pulling direction)  
- template.inp -> an exemplary input file to NAMD, in which all simulation parameters are set  
  
  
################### installation ##########################
  
  
The script is written in the Python 3 standard (generally applicable).  
However, it requires the installation of several additional Python packages that are not included in the standard installation. These are NumPy, SciPy, and MDAnalysis.  
  
Install them using the pip command:  

*pip install numpy scipy MDAnalysis*  
  
or using conda:  
  
*conda install numpy scipy MDAnalysis*  
  

################### generation of SMD inputs ######################  

  
Suggested changes in both SMDgen_Nav_inactivation.py and SMDgen_Nav_recovery.py files:  
- line 25 - change the output directory name  
- line 55 - define the binding pocket based on the numbering of your Nav  
- line 64 - you can play with desired directions of pulling (you can see the visualization of the vectors after running the script, using vmd.tcl file in the VMD program)  
  

Run the program in terminal (Linux) by typing in the command line (being in the directory where you downloaded the script).  

Example command to run SMDgen if you use files from CHARMM-GUI:  

*zip -r toppar.zip toppar*  

to pack parameters  

*python SMDgen_Nav_inactivation.py step5_input.pdb step5_input.psf step7.1_production.vel step7.1_production.coor step7.1_production.xsc toppar.zip template.inp template.sh
'protein and name CA and resid 387 972 1498 1791' 'protein and name CA and resid 1565:1567'*  


  where:  
	- selection 1 - constrained atoms  
	- selection 2 - pulled atoms  
	- template.inp - an input file to namd with all simulation parameters set; an exemplary file is given  
	- template.sh - a run.bash file that you need to submit a job (to start SMD calculations using inputs generated by the python script)  
  

########################## analysis ##########################  

  
Scripts for data analysis should be in the same directory as SMDgen_Nav_inactivation.py or SMDgen_Nav_recovery.py files  

Suggested changes in analyze_singlerep_alldirs.py :  
- lines 59 and 62 - change the residues to count Hbonds (here: F1566 and the pocket)  
- line 79 - change the selection of pocket residues to calculate distance  
- line 80 - change the selection of your IFM/MFM motif to calculate distance  
- line 101 - give the name of the directories according to the directions you want to analyze  
  
Suggested changes in analyze_nreps_onedir.py :  
- line 21 - change the name of the directory based on the direction you want to analyze  
- lines 59 and 62 - change the residues to count Hbonds (here: F1566 and the pocket)  
- line 79 - change the selection of pocket residues to calculate distance  
- line 80 - change the selection of your IFM/MFM motif to calculate distance  
- line 101 - repeat the name of the directory according to the direction you want to analyze  

example command to run analyze_singlerep_alldirs.py :  

*python analyze_singlerep_alldirs.py smd_NAME sel1 sel2*  

  
example command to run analyze_nreps_onedir.py :  

*python analyze_nreps_onedir.py smd_NAME selection1 selection2 nrep*  

  where:  
	- selection1 - constrained atoms  
	- selection2 - pulled atoms (IFM/MFM)  
	- nrep - number of trajectories to analyze  
  
